<!DOCTYPE html>

<html>

    <head>
        <title>Metadata</title>
        <meta charset='UTF-8'>
        <script src='metadata.js'></script> 
    </head>
    
    <body>
        <script>
        /*
            MD.get('im.tif', 
                function(buffer) {
                    var tiff = new MD.Tiff(buffer);
                    var list = tiff.enumerate();
                    for (var i = 0; i < list.length; i++) {
                        console.log(list[i].path + ' (' + list[i].tag.id + '): ' + list[i].tag.data);
                    }
                },
                function() {
                    throw 'Failed to fetch image';
                })
               */
        
            MD.get('im.jpg', 
                function(buffer) {
                    var jpeg = new MD.Jpeg(buffer);
                    var exifBuffer = jpeg.getExifBuffer();
                    if (exifBuffer) {
                        var exif = new MD.Tiff(exifBuffer);
                        
                        //var tags = exif.getTagsByPath('/ifd[0]/exif[0]/ifd[0]');
                        //console.log(tags);
                        
                        exif.addTag('/ifd[5]', {id: 123, type: 2, data: 'thomas'});
                        
                        var list = exif.enumerate();
                        for (var i = 0; i < list.length; i++) {
                            console.log(list[i].path + ' (' + list[i].tag.id + '): ' + list[i].tag.data);
                        }
                    }
                },
                function() {
                    throw 'Failed to fetch image';
                });
                
        </script>
    </body>

</html>